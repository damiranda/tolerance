---
title: "analisis-preliminar"
author: "Kevin Carrasco"
date: "26-01-2021"
output:
  pdf_document: default
  html_document: default
---

```{r}
pacman::p_load(stargazer, ggplot2, sjmisc, car, sjlabelled, haven, cowplot,
               sjPlot, summarytools, kableExtra, corrplot, coefplot, ltm, polycor,
               psych, lme4, ppcor, dplyr, texreg)
```

# Cargar base desde github
```{r}

load("../input/data-proc/data.rda")

```
# Descriptivos
## Igualdad de género estudiantes
```{r}
#Seleccionar variables
est_igualdad=data %>% dplyr::select(Igualdad1.est, Igualdad5.est, Igualdad7.est, Igualdad3.est, Igualdad4.est, Igualdad6.est, Igualdad2.est, Igualdad8.est, Igualdad9.est) %>% as.data.frame()
# Cambiar etiquetas
est_igualdad$Igualdad1.est <- set_label(x = est_igualdad$Igualdad1.est, label = "Los hombres y las mujeres deberían tener las mismas oportunidades de participar en el gobierno")
est_igualdad$Igualdad2.est <- set_label(x = est_igualdad$Igualdad2.est, label = "La primera prioridad de las mujeres debería ser criar hijos")
est_igualdad$Igualdad3.est <- set_label(x = est_igualdad$Igualdad3.est, label = "Las mujeres deberían permanecer alejadas de la política")
est_igualdad$Igualdad4.est <- set_label(x = est_igualdad$Igualdad4.est, label = "Cuando no hay muchos trabajos disponibles, los hombres deberían tener más derecho a un trabajo que las mujeres")
est_igualdad$Igualdad5.est <- set_label(x = est_igualdad$Igualdad5.est, label = "Los hombres y las mujeres deberían recibir el mismo pago cuando hacen los mismos trabajos")
est_igualdad$Igualdad6.est <- set_label(x = est_igualdad$Igualdad6.est, label = "Los hombres están mejor preparados para ser líderes políticos que las mujeres")
est_igualdad$Igualdad7.est <- set_label(x = est_igualdad$Igualdad7.est, label = "Los hombres y las mujeres deberían tener los mismos derechos en todos los aspectos")
est_igualdad$Igualdad8.est <- set_label(x = est_igualdad$Igualdad8.est, label = "El rol más importante de una mujer es cuidar su hogar y cocinar para su familia")
est_igualdad$Igualdad9.est <- set_label(x = est_igualdad$Igualdad9.est, label = "Un hombre debe tener la última palabra sobre las decisiones del hogar")
#Crear gráfico
graf_igualdad_est <- plot_likert(est_igualdad,
  groups = NULL,
  groups.titles = "auto",
  title = "Existen diferentes visiones sobre el papel de las mujeres y los hombres en la sociedad. ¿Cuán de acuerdo o en desacuerdo estás con las siguientes afirmaciones?",
  legend.labels = c("Muy en desacuerdo", "En desacuerdo", "De acuerdo", "Muy de acuerdo"),
  axis.titles = NULL,
  axis.labels = NULL,
  catcount = 4,
  cat.neutral = NULL,
  sort.frq = NULL,
  weight.by = data$pond_estudiante_reg_dep_tens,
  title.wtd.suffix = NULL,
  wrap.title = 55,
  wrap.labels = 36,
  geom.size = 0.8,
  geom.colors ="Purples",
  reverse.colors = FALSE,
  values = "sum.outside",
  show.n = F,
  show.legend = TRUE,
  show.prc.sign = T,
  grid.range = 1.2,
  grid.breaks = 0.5,
  expand.grid = FALSE,
  digits = 0,
  reverse.scale = TRUE,
  coord.flip = TRUE,
  sort.groups = TRUE,
  rel_heights = 1,
  group.legend.options = list(nrow = NULL, byrow = TRUE),
  cowplot.options = list(label_x = 0.01, hjust = 0.5, vjust=0.5, align = "v")) + theme_bw() + theme(plot.title = element_text(size=14, face = "bold", hjust=0.5),
                      axis.text.y = element_text(size=10, face = "bold"), legend.position = "bottom", legend.text = element_text(size=10, face="bold"))
graf_igualdad_est
#Guardar gráfico
ggsave(graf_igualdad_est, file = "../output/igualdad_de_genero_estudiantes.png",device = "png",width = 21,height = 16,dpi = "retina",units = "cm")
```
## Igualdad de género apoderados
```{r}
#Seleccionar variables
apod_igualdad=data %>% dplyr::select(Igualdad1.pad, Igualdad5.pad, Igualdad7.pad, Igualdad3.pad, Igualdad4.pad, Igualdad6.pad, Igualdad2.pad, Igualdad8.pad, Igualdad9.pad) %>% as.data.frame()
# Cambiar etiquetas
apod_igualdad$Igualdad1.pad <- set_label(x = apod_igualdad$Igualdad1.pad, label = "Los hombres y las mujeres deberían tener las mismas oportunidades de participar en el gobierno")
apod_igualdad$Igualdad2.pad <- set_label(x = apod_igualdad$Igualdad2.pad, label = "La primera prioridad de las mujeres debería ser criar hijos")
apod_igualdad$Igualdad3.pad <- set_label(x = apod_igualdad$Igualdad3.pad, label = "Las mujeres deberían permanecer alejadas de la política")
apod_igualdad$Igualdad4.pad <- set_label(x = apod_igualdad$Igualdad4.pad, label = "Cuando no hay muchos trabajos disponibles, los hombres deberían tener más derecho a un trabajo que las mujeres")
apod_igualdad$Igualdad5.pad <- set_label(x = apod_igualdad$Igualdad5.pad, label = "Los hombres y las mujeres deberían recibir el mismo pago cuando hacen los mismos trabajos")
apod_igualdad$Igualdad6.pad <- set_label(x = apod_igualdad$Igualdad6.pad, label = "Los hombres están mejor preparados para ser líderes políticos que las mujeres")
apod_igualdad$Igualdad7.pad <- set_label(x = apod_igualdad$Igualdad7.pad, label = "Los hombres y las mujeres deberían tener los mismos derechos en todos los aspectos")
apod_igualdad$Igualdad8.pad <- set_label(x = apod_igualdad$Igualdad8.pad, label = "El rol más importante de una mujer es cuidar su hogar y cocinar para su familia")
apod_igualdad$Igualdad9.pad <- set_label(x = apod_igualdad$Igualdad9.pad, label = "Un hombre debe tener la última palabra sobre las decisiones del hogar")
# Crear Gráfico
graf_igualdad_apod <- plot_likert(apod_igualdad,
  groups = NULL,
  groups.titles = "auto",
  title = "Existen diferentes visiones sobre el papel de las mujeres y los hombres en la sociedad. ¿Cuán de acuerdo o en desacuerdo estás con las siguientes afirmaciones?",
  legend.labels = c("Muy en desacuerdo", "En desacuerdo", "De acuerdo", "Muy de acuerdo"),
  axis.titles = NULL,
  axis.labels = NULL,
  catcount = 4,
  cat.neutral = NULL,
  sort.frq = NULL,
  weight.by = data$pond_apoderado_reg_dep_tens,
  title.wtd.suffix = NULL,
  wrap.title = 55,
  wrap.labels = 36,
  geom.size = 0.8,
  geom.colors ="Purples",
  reverse.colors = FALSE,
  values = "sum.outside",
  show.n = F,
  show.legend = TRUE,
  show.prc.sign = T,
  grid.range = 1.2,
  grid.breaks = 0.5,
  expand.grid = FALSE,
  digits = 0,
  reverse.scale = TRUE,
  coord.flip = TRUE,
  sort.groups = TRUE,
  rel_heights = 1,
  group.legend.options = list(nrow = NULL, byrow = TRUE),
  cowplot.options = list(label_x = 0.01, hjust = 0.5, vjust=0.5, align = "v")) + theme_bw() + theme(plot.title = element_text(size=14, face = "bold", hjust=0.5),
                      axis.text.y = element_text(size=10, face = "bold"), legend.position = "bottom", legend.text = element_text(size=10, face="bold"))
graf_igualdad_apod
#Guardar gráfico
ggsave(graf_igualdad_apod, file = "../output/igualdad_de_genero_apoderados.png",device = "png",width = 21,height = 16,dpi = "retina",units = "cm")
```
## Perceción de aula abierta a la discusión estudiantes
```{r}
#Seleccionar variables
est_apdis=data %>% dplyr::select(Ap_discusion1, Ap_discusion2, Ap_discusion3, Ap_discusion4, Ap_discusion5, Ap_discusion6, Ap_discusion7) %>% as.data.frame()
# Cambiar etiquetas
est_apdis$Ap_discusion1 <- set_label(x = est_apdis$Ap_discusion1, label = "Los estudiantes pueden manifestar abiertamente su desacuerdo con sus profesores(as)")
est_apdis$Ap_discusion2 <- set_label(x = est_apdis$Ap_discusion2, label = "Los(as) profesores(as) estimulan a los estudiantes a expresar sus opiniones")
est_apdis$Ap_discusion3 <- set_label(x = est_apdis$Ap_discusion3, label = "Los estudiantes plantean hechos políticos de actualidad para ser discutidos en clases")
est_apdis$Ap_discusion4 <- set_label(x = est_apdis$Ap_discusion4, label = "Los estudiantes expresan sus opiniones en clases, aun cuando sean distintas a las de los demás")
est_apdis$Ap_discusion5 <- set_label(x = est_apdis$Ap_discusion5, label = "Los(as) profesores(as) estimulan a los estudiantes a conversar los temas con gente que opina distinto")
est_apdis$Ap_discusion6 <- set_label(x = est_apdis$Ap_discusion6, label = "Los(as) profesores(as) exponen los temas desde distintos puntos de vista al explicarlos en clases")
est_apdis$Ap_discusion7 <- set_label(x = est_apdis$Ap_discusion7, label = "Los(as) profesores(as) fomentan la reflexión y la crítica")
# Crear Gráfico
graf_est_apdis <- plot_likert(est_apdis,
  groups = NULL,
  groups.titles = "auto",
  title = "Cuando se discuten temas políticos y sociales durante las clases, ¿Con qué frecuencia suceden las siguientes situaciones?",
  legend.labels = c("Nunca", "Casi nunca", "A veces", "Siempre"),
  axis.titles = NULL,
  axis.labels = NULL,
  catcount = 4,
  cat.neutral = NULL,
  sort.frq = "neg.asc",
  weight.by = data$pond_estudiante_reg_dep_tens,
  title.wtd.suffix = NULL,
  wrap.title = 55,
  wrap.labels = 36,
  #wrap.legend.title = 30,
  #wrap.legend.labels = 13,
  geom.size = 0.8,
  geom.colors ="Purples",
  #cat.neutral.color = "grey70",
  #intercept.line.color = "grey50",
  reverse.colors = FALSE,
  values = "sum.outside",
  show.n = F,
  show.legend = TRUE,
  show.prc.sign = T,
  grid.range = 1.2,
  grid.breaks = 0.5,
  expand.grid = FALSE,
  digits = 0,
  reverse.scale = TRUE,
  coord.flip = TRUE,
  sort.groups = TRUE,
  rel_heights = 1,
  group.legend.options = list(nrow = NULL, byrow = TRUE),
  cowplot.options = list(label_x = 0.01, hjust = 0.5, vjust=0.5, align = "v")) + theme_bw() + theme(plot.title = element_text(size=14, face = "bold", hjust=0.5),
                      axis.text.y = element_text(size=10, face = "bold"), legend.position = "bottom", legend.text = element_text(size=10, face="bold"))
graf_est_apdis
ggsave(graf_est_apdis, file = "../output/percepcion_apertura_a_la_discusion_estudiantes.png",device = "png",width = 21,height = 15,dpi = "retina",units = "cm")
```
## Otros descriptivos
```{r}
view(dfSummary(dplyr::select(data, Sexo, Ed_madre, Ed_padre, Ed_padres, Educacion, Libros_est, Libros_apod), headings=FALSE))

#file="../output/descriptivos recursos de la familia.png"
```
# Correlaciones
## Igualdad de género estudiantes
```{r}
png("../output/cor_indicadores_ig_est.png",width=600,height=600)
corrplot.mixed(cor(dplyr::select(data,Igualdad1.est, Igualdad5.est, Igualdad7.est, Igualdad3.est, Igualdad4.est, Igualdad6.est, Igualdad2.est, Igualdad8.est, Igualdad9.est),
                   use = "na.or.complete", method="spearman"))
dev.off()

#png("../output/cor_indicadores_ig_est.png",width=600,height=400)
windowsFonts(A = windowsFont("Times New Roman"))
cormat <- cor(dplyr::select(data,Igualdad1.est, Igualdad5.est, Igualdad7.est, Igualdad3.est, Igualdad4.est, Igualdad6.est, Igualdad2.est, Igualdad8.est, Igualdad9.est), use = "na.or.complete")
rownames(cormat) <-c(
    "A. Iguales oportunidades de participar en el gobierno",
    "B. Hombres y mujeres deberían recibir el mismo pago",
    "C. Hombres y mujeres deberían tener los mismos derechos",
    "D. Mujeres deberían permanecer alejadas de la política",
    "E. Hombres deberían tener más derecho a un trabajo",
    "F. Hombres están más preparados para ser líderes políticos",
    "G. Primera prioridad de las mujeres es criar hijos",
    "H. El rol de una mujer es cuidar su hogar y familia",
    "I. Hombres deben tener la última palabra sobre el hogar")
colnames(cormat) <-c("(A)", "(B)","(C)","(D)","(E)", "(F)","(G)","(H)","(I)")
corrplot(
cormat,
  method = "color",
  type = "upper",
  tl.col = "black",
  addCoef.col = "black",
  diag = TRUE,
  family = "A",
  number.font = 6,
  tl.cex =0.75,
  number.cex = 1)
```
## Correlaciones puntuaciones factoriales estudiantes
```{r}
png("../output/cor_punt_fact_ig_est.png",width=600,height=600)
corrplot.mixed(cor(dplyr::select(data, igualdad.est, esp_publico.est, esp_privado.est),
                   use = "na.or.complete"))
dev.off()

windowsFonts(A = windowsFont("Times New Roman"))
cormat <- cor(dplyr::select(data, igualdad.est, esp_publico.est, esp_privado.est),
                   use = "na.or.complete")

rownames(cormat) <-c(
    "A. Igualdad de derechos en general",
    "B. Supremacía masculina en el espacio publico",
    "C. Supremacía masculina en el espacio privado")
colnames(cormat) <-c("(A)", "(B)","(C)")
corrplot(
cormat,
  method = "color",
  type = "upper",
  tl.col = "black",
  addCoef.col = "black",
  diag = TRUE,
  family = "A",
  number.font = 6,
  tl.cex =0.75,
  number.cex = 1)
```
## Igualdad de género apoderados
```{r}
png("../output/cor_indicadores_ig_apod.png",width=600,height=600)
corrplot.mixed(cor(dplyr::select(data,Igualdad1.pad, Igualdad5.pad, Igualdad7.pad, Igualdad3.pad, Igualdad4.pad, Igualdad6.pad, Igualdad2.pad, Igualdad8.pad, Igualdad9.pad),
                   use = "na.or.complete", method="spearman"))
dev.off()
```
## Correlaciones puntuaciones factoriales apoderados
```{r}
png("../output/cor_punt_fact_ig_apod.png",width=600,height=600)
corrplot.mixed(cor(dplyr::select(data, igualdad.pad, esp_publico.pad, esp_privado.pad),
                   use = "na.or.complete"))
dev.off()
```
## Libros (estudiantes y apoderados)
```{r}
png("../output/cor_libros_est_apod.png",width=600,height=600)
corrplot.mixed(cor(dplyr::select(data, Libros_est, Libros_apod, Libros),
                   use = "na.or.complete", method="spearman"))
dev.off()
```

## Educación padres (estudiantes y apoderados) con corrplot spearman
```{r}
png("../output/cor_ed_pad.png",width=600,height=600)

corrplot.mixed(cor(dplyr::select(data, Ed_padre, Ed_padres, Educacion, Educ_padre),
                   use = "na.or.complete", method="spearman"))
dev.off()

cor1 <- corrplot.mixed(cor(dplyr::select(data, Ed_padre, Ed_padres, Educacion),
                   use = "na.or.complete", method="spearman"))

png("../output/cor_ed_mad.png",width=600,height=600)

corrplot.mixed(cor(dplyr::select(data,Ed_madre, Ed_padres, Educacion, Educ_madre),
                   use = "na.or.complete", method="spearman"))
dev.off()

cor2 <- corrplot.mixed(cor(dplyr::select(data,Ed_madre, Ed_padres, Educacion),
                   use = "na.or.complete", method="spearman"))
```

## Educación padres (estudiantes y apoderados) con polychoric de psych
```{r}
educ=data %>% dplyr::select("Educ. madre"=Ed_madre, "Educ. padre"=Ed_padre, "Educ padres"=Ed_padres, "Educación padres"=Educacion) %>% as.data.frame()
polychoric(educ,smooth=TRUE,global=TRUE,polycor=FALSE, ML = FALSE,
       std.err=FALSE,weight=NULL,progress=TRUE,na.rm=TRUE, delete=TRUE)
```

## Igualdad de género y sexo
```{r}
# level = 2 es la categoría a utilizar, en este caso mujer (2)
biserial.cor(data$igualdad.est,data$Sexo, use = c("complete.obs"), level = 2) 

biserial.cor(data$esp_publico.est,data$Sexo, use = c("complete.obs"), level = 2)

biserial.cor(data$esp_privado.est,data$Sexo, use = c("complete.obs"), level = 2)
```

## Tabla correlaciones biseriales igualdad de género y sexo

| Variable                                     	| Sexo  	|
|----------------------------------------------	|-------	|
| Igualdad de derechos entre hombres y mujeres 	| 0.16  	|
| Distribución de poder en el espacio público  	| -0.21  	|
| Distribución de poder en el espacio privado  	| -0.21  	|

## Igualdad de género estudiantes y recursos de la familia
```{r}
png("../output/cor_ig_est_recursos.png",width=600,height=600)
corrplot.mixed(cor(dplyr::select(data, igualdad.est, esp_publico.est, esp_privado.est, Educ_padre, Educ_madre, Libros, Ingresos),
                   use = "na.or.complete"))
dev.off()
```

## Igualdad de género estudiantes y apoderados (puntuaciones factoriales)
```{r}
png("../output/cor_fact_ig_est_apod.png",width=600,height=600)
corrplot.mixed(cor(dplyr::select(data, igualdad.est, esp_publico.est, esp_privado.est, igualdad.pad, esp_publico.pad, esp_privado.pad),
                   use = "na.or.complete"))
dev.off()
```
## Igualdad de género apoderados y recursos de la familia
```{r}
png("../output/cor_ig_apod_recursos.png",width=600,height=600)
corrplot.mixed(cor(dplyr::select(data, igualdad.pad, esp_publico.pad, esp_privado.pad, Educ_padre, Educ_madre, Libros, Ingresos),
                   use = "na.or.complete"))
dev.off()
```
## Correlación parcial entre igualdad de género estudiantes, apoderados y recursos de la familia
```{r}
#Primero correlación directa
cor(dplyr::select(data, igualdad.est, Ed_apod), use = "na.or.complete")
```

```{r}
# después correlación parcializada
partial.r(data=data, x=c("igualdad.est","Ed_apod"), y="igualdad.pad")

```
## Igualdad de género estudiantes, Apertura a la discusion en el aula Y proporción de niñas
```{r}
png("../output/cor_ig_est_escuela.png",width=600,height=600)
corrplot.mixed(cor(dplyr::select(data, igualdad.est, esp_publico.est, esp_privado.est, ap_discusion, mean_discusion, num_fem),
                   use = "na.or.complete"))
dev.off()
```
# Modelos de regresión

## Primero modelo nulo
```{r}
data$RBD <- as.factor(data$RBD)

reg0_igualdad <- lmer(igualdad.est ~ 1 + (1 | RBD), data=data)
reg0_pub <- lmer(esp_publico.est ~ 1 + (1 | RBD), data=data)
reg0_priv <- lmer(esp_privado.est ~ 1 + (1 | RBD), data=data)

stargazer(reg0_igualdad,reg0_pub, reg0_priv,
  column.labels=c("Igualdad","Espacio público", "Espacio privado"),
  type ='text')

screenreg(list(reg0_igualdad,reg0_pub, reg0_priv))
```
## Modelos con variables individuales
```{r}
# Pasar variables educación a categorías
data$Ed.madre.cat = as.factor(data$Educ_madre)
data$Ed.padre.cat = as.factor(data$Educ_padre)
# Ponerle nombre a las categorías
data$Ed.madre.cat <- set_labels(data$Ed.madre.cat, labels=c("8vo básico o menos" = 1, 
                                                            "Educación media" = 2,
                                                            "Educación técnica superior" = 3, 
                                                            "Educación Universitaria o más" = 4))

data$Ed.padre.cat <- set_labels(data$Ed.padre.cat, labels=c("8vo básico o menos" = 1, 
                                                            "Educación media" = 2, 
                                                            "Educación técnica superior" = 3, 
                                                            "Educación Universitaria o más" = 4))


# Var dep igualdad de derechos estudiantes
reg1_igualdad <- lmer(igualdad.est ~ 1 + Sexo + (1 | RBD), data=data)

reg2_igualdad <- lmer(igualdad.est ~ 1 + Ed.madre.cat + Ed.padre.cat + factor(Libros) + Ingresos + (1 | RBD), data=data)

reg3_igualdad <- lmer(igualdad.est ~ 1 + igualdad.pad + (1 | RBD), data=data)

reg4_igualdad <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + factor(Libros) + Ingresos + igualdad.pad + (1 | RBD), data=data)

stargazer(reg1_igualdad, reg2_igualdad, reg3_igualdad, reg4_igualdad,
  column.labels=c("Modelo 1", "Modelo 2", "Modelo 3", "Modelo 4"),
  type ='text')

screenreg(list(reg1_igualdad, reg2_igualdad, reg3_igualdad, reg4_igualdad))
```
```{r}
# Recursos de la familia por separado
reg1_rec <- lmer(igualdad.est ~ 1 + Educ_madre + (1 | RBD), data=data)
reg2_rec <- lmer(igualdad.est ~ 1 + Educ_padre + (1 | RBD), data=data)
reg3_rec <- lmer(igualdad.est ~ 1 + Libros + (1 | RBD), data=data)
reg4_rec <- lmer(igualdad.est ~ 1 + Ingresos + (1 | RBD), data=data)
reg5_rec <- lmer(igualdad.est ~ 1 + Educ_madre + Educ_padre + Libros + (1 | RBD), data=data)

screenreg(list(reg1_rec, reg2_rec, reg3_rec,reg4_rec,reg5_rec))
```
```{r}
reg1_rec <- lmer(esp_publico.est ~ 1 + Educ_madre + (1 | RBD), data=data)
reg2_rec <- lmer(esp_publico.est ~ 1 + Educ_padre + (1 | RBD), data=data)
reg3_rec <- lmer(esp_publico.est ~ 1 + Libros + (1 | RBD), data=data)
reg4_rec <- lmer(esp_publico.est ~ 1 + Ingresos + (1 | RBD), data=data)
reg5_rec <- lmer(esp_publico.est ~ 1 + Educ_madre + Educ_padre + Libros + (1 | RBD), data=data)

screenreg(list(reg1_rec, reg2_rec, reg3_rec,reg4_rec,reg5_rec))
```

```{r}
data$Ed_padres = as.factor(data$Ed_padres)

reg1_educ <- lmer(igualdad.est ~ 1 + Ed_padres + (1 | RBD), data=data)
reg2_educ <- lmer(esp_publico.est ~ 1 + Ed_padres + (1 | RBD), data=data)
reg3_educ <- lmer(esp_privado.est ~ 1 + Ed_padres + (1 | RBD), data=data)

screenreg(list(reg1_educ, reg2_educ, reg3_educ))
```


```{r}
## Modelo alternativo con las tres actitudes de apoderados
# Var dep igualdad de derechos estudiantes
reg1_igualdad.act <- lmer(igualdad.est ~ 1 + Sexo + (1 | RBD), data=data)

reg2_igualdad.act <- lmer(igualdad.est ~ 1 + Ed.madre.cat + Ed.padre.cat + Libros + Ingresos + (1 | RBD), data=data)

reg3_igualdad.act <- lmer(igualdad.est ~ 1 + igualdad.pad + esp_publico.pad + esp_privado.pad + (1 | RBD), data=data)

reg4_igualdad.act <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + Ingresos + igualdad.pad + esp_publico.pad + esp_privado.pad + (1 | RBD), data=data)

stargazer(reg1_igualdad.act, reg2_igualdad.act, reg3_igualdad.act, reg4_igualdad.act,
  column.labels=c("Modelo 1", "Modelo 2", "Modelo 3", "Modelo 4"),
  type ='text')

screenreg(list(reg1_igualdad.act, reg2_igualdad.act, reg3_igualdad.act, reg4_igualdad.act))
```
```{r}
## Modelo alternativo sin ingresos para recuperar casos
# Var dep igualdad de derechos estudiantes
reg1_igualdad.ing <- lmer(igualdad.est ~ 1 + Sexo + (1 | RBD), data=data)

reg2_igualdad.ing <- lmer(igualdad.est ~ 1 + Ed.madre.cat + Ed.padre.cat + Libros + (1 | RBD), data=data)

reg3_igualdad.ing <- lmer(igualdad.est ~ 1  + esp_publico.pad + esp_privado.pad + (1 | RBD), data=data)

reg4_igualdad.ing <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + (1 | RBD), data=data)

stargazer(reg1_igualdad.ing, reg2_igualdad.ing, reg3_igualdad.ing, reg4_igualdad.ing,
  column.labels=c("Modelo 1", "Modelo 2", "Modelo 3", "Modelo 4"),
  type ='text')

screenreg(list(reg1_igualdad.ing, reg2_igualdad.ing, reg3_igualdad.ing, reg4_igualdad.ing))
```
```{r}
reg3a_igualdad.ing <- lmer(igualdad.est ~ 1  + igualdad.pad + (1 | RBD), data=data)

reg3b_igualdad.ing <- lmer(igualdad.est ~ 1  + esp_publico.pad  + (1 | RBD), data=data)
reg3c_igualdad.ing <- lmer(igualdad.est ~ 1  +  esp_privado.pad + (1 | RBD), data=data)

screenreg(list(reg3a_igualdad.ing,reg3b_igualdad.ing,reg3c_igualdad.ing))
```



```{r}
# Var dep espacio publico estudiantes
reg1_esp.pub <- lmer(esp_publico.est ~ 1 + Sexo + (1 | RBD), data=data)

reg2_esp.pub <- lmer(esp_publico.est ~ 1 + Ed.madre.cat + Ed.padre.cat + Libros + Ingresos + (1 | RBD), data=data)

reg3_esp.pub <- lmer(esp_publico.est ~ 1 + esp_publico.pad + (1 | RBD), data=data)

reg4_esp.pub <- lmer(esp_publico.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + Ingresos + esp_publico.pad + (1 | RBD), data=data)

stargazer(reg1_esp.pub, reg2_esp.pub, reg3_esp.pub, reg4_esp.pub,
  column.labels=c("Modelo 1", "Modelo 2", "Modelo 3", "Modelo 4"),
  type ='text')

screenreg(list(reg1_esp.pub, reg2_esp.pub, reg3_esp.pub, reg4_esp.pub))
```
```{r}
# Var dep espacio privado estudiantes
reg1_esp.priv <- lmer(esp_privado.est ~ 1 + Sexo + (1 | RBD), data=data)

reg2_esp.priv <- lmer(esp_privado.est ~ 1 + Ed.madre.cat + Ed.padre.cat + Libros + Ingresos + (1 | RBD), data=data)

reg3_esp.priv <- lmer(esp_privado.est ~ 1 + esp_privado.pad + (1 | RBD), data=data)

reg4_esp.priv <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + Ingresos + esp_privado.pad + (1 | RBD), data=data)

stargazer(reg1_esp.priv, reg2_esp.priv, reg3_esp.priv, reg4_esp.priv,
  column.labels=c("Modelo 1", "Modelo 2", "Modelo 3", "Modelo 4"),
  type ='text')

screenreg(list(reg1_esp.priv, reg2_esp.priv, reg3_esp.priv, reg4_esp.priv))
```

```{r}
# Los recursos de la familia también inciden en las actitudes de los apoderados
reg1_igualdad.apod <- lmer(igualdad.pad ~ 1 + Ed.madre.cat + Ed.padre.cat + Libros + Ingresos + (1 | RBD), data=data)
reg1_esp_pub.apod <- lmer(esp_publico.pad ~ 1 + Ed.madre.cat + Ed.padre.cat + Libros + Ingresos + (1 | RBD), data=data)
reg1_esp_priv.apod <- lmer(esp_privado.pad ~ 1 + Ed.madre.cat + Ed.padre.cat + Libros + Ingresos + (1 | RBD), data=data)

stargazer(reg1_igualdad.apod, reg1_esp_pub.apod, reg1_esp_priv.apod,
  column.labels=c("Modelo 1", "Modelo 2", "Modelo 3"),
  type ='text')

screenreg(list(reg1_igualdad.apod, reg1_esp_pub.apod, reg1_esp_priv.apod))
```
## Modelos con variables contextuales
```{r}
# Var dep igualdad de derechos estudiantes
reg1_igualdad.agg <- lmer(igualdad.est ~ 1 + mean_discusion + (1 | RBD), data=data)

reg2_igualdad.agg <- lmer(igualdad.est ~ 1 + num_fem + (1 | RBD), data=data)

reg3_igualdad.agg <- lmer(igualdad.est ~ 1 + mean_discusion + num_fem + (1 | RBD), data=data)

stargazer(reg1_igualdad.agg, reg2_igualdad.agg, reg3_igualdad.agg,
  column.labels=c("Modelo 1", "Modelo 2", "Modelo 3"),
  type ='text')

screenreg(list(reg1_igualdad.agg, reg2_igualdad.agg, reg3_igualdad.agg))
```
```{r}
# Var dep Espacio público estudiantes

reg1_esp.pub.agg <- lmer(esp_publico.est ~ 1 + mean_discusion + (1 | RBD), data=data)

reg2_esp.pub.agg <- lmer(esp_publico.est ~ 1 + num_fem + (1 | RBD), data=data)

reg3_esp.pub.agg <- lmer(esp_publico.est ~ 1 + mean_discusion + num_fem + (1 | RBD), data=data)

stargazer(reg1_esp.pub.agg, reg2_esp.pub.agg, reg3_esp.pub.agg,
  column.labels=c("Modelo 1", "Modelo 2", "Modelo 3"),
  type ='text')

screenreg(list(reg1_esp.pub.agg, reg2_esp.pub.agg, reg3_esp.pub.agg))
```
```{r}
# Var dep Espacio público estudiantes

reg1_esp.priv.agg <- lmer(esp_privado.est ~ 1 + mean_discusion + (1 | RBD), data=data)

reg2_esp.priv.agg <- lmer(esp_privado.est ~ 1 + num_fem + (1 | RBD), data=data)

reg3_esp.priv.agg <- lmer(esp_privado.est ~ 1 + mean_discusion + num_fem + (1 | RBD), data=data)

stargazer(reg1_esp.priv.agg, reg2_esp.priv.agg, reg3_esp.priv.agg,
  column.labels=c("Modelo 1", "Modelo 2", "Modelo 3"),
  type ='text')

screenreg(list(reg1_esp.priv.agg, reg2_esp.priv.agg, reg3_esp.priv.agg))
```
## Modelos con variables individuales y contextuales
```{r}
# Var dep igualdad de derechos estudiantes
reg1_igualdad.incon <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + (1 | RBD), data=data)

reg2_igualdad.incon <- lmer(igualdad.est ~ 1 + mean_discusion + num_fem + (1 | RBD), data=data)

reg3_igualdad.incon <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 | RBD), data=data)

screenreg(list(reg1_igualdad.incon, reg2_igualdad.incon, reg3_igualdad.incon))
```
```{r}
# Var dep espacio publico estudiantes
reg1_esp.pub.incon <- lmer(esp_publico.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + (1 | RBD), data=data)

reg2_esp.pub.incon <- lmer(esp_publico.est ~ 1 + mean_discusion + num_fem + (1 | RBD), data=data)

reg3_esp.pub.incon <- lmer(esp_publico.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 | RBD), data=data)

screenreg(list(reg1_esp.pub.incon, reg2_esp.pub.incon, reg3_esp.pub.incon))
```
```{r}
# Var dep espacio privado estudiantes
reg1_esp.priv.incon <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + (1 | RBD), data=data)

reg2_esp.priv.incon <- lmer(esp_privado.est ~ 1 + mean_discusion + num_fem + (1 | RBD), data=data)

reg3_esp.priv.incon <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 | RBD), data=data)

screenreg(list(reg1_esp.priv.incon, reg2_esp.priv.incon, reg3_esp.priv.incon))
```
## Modelos interacción entre niveles
results_5 = lmer(mathach ~ 1 + female + ses*sector + mnses + (1 + ses | schoolid), data = mlm)
```{r}
# Efecto moderador  del  género sobre los recursos de la familia 
# Var dep igualdad de derechos estudiantes
reg1_igualdad.inter <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat*Sexo + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Ed.madre.cat | RBD), data=data)

reg2_igualdad.inter <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat*Sexo + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Ed.padre.cat | RBD), data=data)

reg3_igualdad.inter <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros*Sexo + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Libros | RBD), data=data)

screenreg(list(reg1_igualdad.inter, reg2_igualdad.inter, reg3_igualdad.inter))
```
```{r}
# Efecto moderador  del  género sobre los recursos de la familia 
# Var dep espacio privado estudiantes
reg1_esp.priv.inter <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat*Sexo + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Ed.madre.cat | RBD), data=data)

reg2_esp.priv.inter <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat*Sexo + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Ed.padre.cat | RBD), data=data)

reg3_esp.priv.inter <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros*Sexo + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Libros | RBD), data=data)

screenreg(list(reg1_esp.priv.inter, reg2_esp.priv.inter, reg3_esp.priv.inter))
```

```{r}
# Efecto moderador  del  género sobre las actitudes de los apoderados 
# Var dep igualdad de derechos estudiantes
reg1_igualdad.interact <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad*Sexo + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + igualdad.pad | RBD), data=data)

reg2_igualdad.interact <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad*Sexo + esp_privado.pad + mean_discusion + num_fem + (1 + esp_publico.pad | RBD), data=data)

reg3_igualdad.interact <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad*Sexo + mean_discusion + num_fem + (1 + esp_privado.pad | RBD), data=data)

screenreg(list(reg1_igualdad.interact, reg2_igualdad.interact, reg3_igualdad.interact))
```
```{r}
# Efecto moderador  del  género sobre las actitudes de los apoderados 
# Var dep espacio privado estudiantes
reg1_esp.priv.interact <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad*Sexo + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + igualdad.pad | RBD), data=data)

reg2_esp.priv.interact <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad*Sexo + esp_privado.pad + mean_discusion + num_fem + (1 + esp_publico.pad | RBD), data=data)

reg3_esp.priv.interact <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad*Sexo + mean_discusion + num_fem + (1 + esp_privado.pad | RBD), data=data)

screenreg(list(reg1_esp.priv.interact, reg2_esp.priv.interact, reg3_esp.priv.interact))
```

```{r}
# Efecto moderador de la apertura a la discusión sobre recursos de la familia
# Var dep igualdad de derechos estudiantes
reg1_igualdad.interdis <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat*mean_discusion + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Ed.madre.cat | RBD), data=data)

reg2_igualdad.interdis <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat*mean_discusion + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Ed.padre.cat | RBD), data=data)

reg3_igualdad.interdis <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros*mean_discusion + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Libros | RBD), data=data)

screenreg(list(reg1_igualdad.interdis, reg2_igualdad.interdis, reg3_igualdad.interdis))
```
```{r}
# Efecto moderador de la apertura a la discusión sobre recursos de la familia
# Var dep espacio privado estudiantes
reg1_esp.priv.interdis <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat*mean_discusion + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Ed.madre.cat | RBD), data=data)

reg2_esp.priv.interdis <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat*mean_discusion + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Ed.padre.cat | RBD), data=data)

reg3_esp.priv.interdis <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros*mean_discusion + igualdad.pad + esp_publico.pad + esp_privado.pad + mean_discusion + num_fem + (1 + Libros | RBD), data=data)

screenreg(list(reg1_esp.priv.interdis, reg2_esp.priv.interdis, reg3_esp.priv.interdis))
```
```{r}
# Efecto moderador de la apertura a la discusión sobre actitudes de los apoderados
# Var dep igualdad de derechos estudiantes
reg1_igualdad.disact <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad*mean_discusion + esp_publico.pad + esp_privado.pad + num_fem + (1 + igualdad.pad | RBD), data=data)

reg2_igualdad.disact <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad*mean_discusion + esp_privado.pad + num_fem + (1 + esp_publico.pad | RBD), data=data)

reg3_igualdad.disact <- lmer(igualdad.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad*mean_discusion + num_fem + (1 + esp_privado.pad | RBD), data=data)

screenreg(list(reg1_igualdad.disact, reg2_igualdad.disact, reg3_igualdad.disact))
```
```{r}
# Efecto moderador de la apertura a la discusión sobre actitudes de los apoderados
# Var dep espacio privado estudiantes
reg1_esp.priv.disact <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad*mean_discusion + esp_publico.pad + esp_privado.pad + num_fem + (1 + igualdad.pad | RBD), data=data)

reg2_esp.priv.disact <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad*mean_discusion + esp_privado.pad + num_fem + (1 + esp_publico.pad | RBD), data=data)

reg3_esp.priv.disact <- lmer(esp_privado.est ~ 1 + Sexo + Ed.madre.cat + Ed.padre.cat + Libros + igualdad.pad + esp_publico.pad + esp_privado.pad*mean_discusion + num_fem + (1 + esp_privado.pad | RBD), data=data)

screenreg(list(reg1_esp.priv.disact, reg2_esp.priv.disact, reg3_esp.priv.disact))
```

#Gráficos de interacciones
## Cantidad de libros en el hogar sobre igualdad de derechos moderado por apertura a la discusión
```{r}
data$igualdad.est<-sjlabelled::remove_all_labels(data$igualdad.est)
data$esp_publico.est<-sjlabelled::remove_all_labels(data$esp_publico.est)
data$esp_privado.est<-sjlabelled::remove_all_labels(data$esp_privado.est)
data$Libros_est<-sjlabelled::remove_all_labels(data$Libros_est)
data$mean_discusion<-sjlabelled::remove_all_labels(data$mean_discusion)
data$Ingresos<-sjlabelled::remove_all_labels(data$Ingresos)
data$Ed_padres<-sjlabelled::remove_all_labels(data$Ed_padres)


reg_igualdad_libros = lmer(igualdad.est ~ 1 + Libros + mean_discusion +
                   Libros*mean_discusion +
                   (1 + Libros | RBD), data=data)
```
```{r}
png("../output/int_ig_lib_discusion.png",width=600,height=400)
plot_model(reg_igualdad_libros, type = "int", mdrt.values="meansd")
dev.off()
```

## Educacion padre sobre igualdad de derechos moderado por apertura a la discusión

```{r}
reg_igualdad_educpad = lmer(igualdad.est ~ 1 + Educ_padre + mean_discusion +
                  Educ_padre*mean_discusion +
                   (1 + Educ_padre | RBD), data=data)
```
```{r}
png("../output/int_ig_edu_discusion.png",width=600,height=400)
plot_model(reg_igualdad_educpad, type = "int", mdrt.values="meansd")
dev.off()
```
## Educacion madre sobre igualdad de derechos moderado por apertura a la discusión

```{r}
reg_igualdad_educmad = lmer(igualdad.est ~ 1 + Educ_madre + mean_discusion +
                  Educ_madre*mean_discusion +
                   (1 + Educ_madre | RBD), data=data)
```
```{r}
png("../output/int_ig_edu_discusion.png",width=600,height=400)
plot_model(reg_igualdad_educmad, type = "int", mdrt.values="meansd")
dev.off()
```
## Cantidad de libros en el hogar sobre distribucion de poder esp privado moderado por apertura a la discusión

```{r}
reg_esppriv_libros = lmer(esp_privado.est ~ 1 + Libros + mean_discusion +
                   Libros*mean_discusion +
                   (1 + Libros | RBD), data=data)

png("../output/int_esp_pri_lib_discusion.png",width=600,height=400)
plot_model(reg_esppriv_libros, type = "int", mdrt.values="meansd")
dev.off()
```
## Educacion padre sobre distribucion de poder esp privado moderado por apertura a la discusión

```{r}
reg_esppriv_educpad = lmer(esp_privado.est ~ 1 + Educ_padre + mean_discusion +
                    Educ_padre*mean_discusion +
                   (1 + Educ_padre | RBD), data=data)

png("../output/int_esp_pri_edu_discusion.png",width=600,height=400)
plot_model(reg_esppriv_educpad, type = "int", mdrt.values="meansd")
dev.off()
```
## Educacion padre sobre distribucion de poder esp privado moderado por apertura a la discusión

```{r}
reg_esppriv_educmad = lmer(esp_privado.est ~ 1 + Educ_madre + mean_discusion +
                    Educ_madre*mean_discusion +
                   (1 + Educ_madre | RBD), data=data)

png("../output/int_esp_pri_edu_discusion.png",width=600,height=400)
plot_model(reg_esppriv_educmad, type = "int", mdrt.values="meansd")
dev.off()
```

## Cantidad de libros en el hogar sobre distribucion de poder esp publico moderado por apertura a la discusión

```{r}
reg_esppub_libro = lmer(esp_publico.est ~ 1 + Libros + mean_discusion +
                   Libros*mean_discusion +
                   (1 + Libros | RBD), data=data)

png("../output/int_esp_pub_lib_discusion.png",width=600,height=400)
plot_model(reg_esppub_libros, type = "int", mdrt.values="meansd")
dev.off()
```
## Educacion padres sobre distribucion de poder esp publico moderado por apertura a la discusión

```{r}
reg_esppub_educpad = lmer(esp_publico.est ~ 1 + Educ_padre + mean_discusion +
                    Educ_padre*mean_discusion +
                   (1 + Educ_padre | RBD), data=data)

png("../output/int_esp_pub_edu_discusion.png",width=600,height=400)
plot_model(reg_esppub_educpad, type = "int", mdrt.values="meansd")
dev.off()
```
```{r}
reg_esppub_educmad = lmer(esp_publico.est ~ 1 + Educ_madre + mean_discusion +
                    Educ_madre*mean_discusion +
                   (1 + Educ_madre | RBD), data=data)

png("../output/int_esp_pub_edu_discusion.png",width=600,height=400)
plot_model(reg_esppub_educmad, type = "int", mdrt.values="meansd")
dev.off()
```

## Cantidad de libros sobre igualdad de derechos moderado por Proporción de niñas
```{r}
data$num_fem<-sjlabelled::remove_all_labels(data$num_fem)


reg_igualdad_libros2 = lmer(igualdad.est ~ 1 + Libros + num_fem +
                   Libros*num_fem +
                   (1 + Libros | RBD), data=data)

png("../output/int_ig_lib_niñas.png",width=600,height=400)
plot_model(reg_igualdad_libros2, type = "int", mdrt.values="meansd")
dev.off()
```
## Educacion padre sobre igualdad de derechos moderado por Proporción de niñas
```{r}
reg_igualdad_educpad2 = lmer(igualdad.est ~ 1 + Educ_padre + num_fem +
                   Educ_padre*num_fem +
                   (1 + Educ_padre | RBD), data=data)

png("../output/int_ig_edu_niñas.png",width=600,height=400)
plot_model(reg_igualdad_educpad2, type = "int", mdrt.values="meansd")
dev.off()
```

## Cantidad de libros sobre distribucion poder esp priv moderado por Proporción de niñas
```{r}
reg_esppriv_libros2 = lmer(esp_privado.est ~ 1 + Libros + num_fem +
                   Libros*num_fem +
                   (1 + Libros | RBD), data=data)

png("../output/int_esp_pri_lib_niñas.png",width=600,height=400)
plot_model(reg_esppriv_libros2, type = "int", mdrt.values="meansd")
dev.off()
```

## Educacion padres sobre distribucion poder esp priv moderado por Proporción de niñas
```{r}
reg_esppriv_educpad2 = lmer(esp_privado.est ~ 1 + Educ_padre + num_fem +
                   Educ_padre*num_fem +
                   (1 + Educ_padre | RBD), data=data)

png("../output/int_esp_pri_edu_niñas.png",width=600,height=400)
plot_model(reg_esppriv_educpad2, type = "int", mdrt.values="meansd")
dev.off()
```
## Cantidad de libros sobre distribucion poder esp publico moderado por Proporción de niñas
```{r}
reg_esppub_libros2 = lmer(esp_publico.est ~ 1 + Libros + num_fem +
                   Libros*num_fem +
                   (1 + Libros | RBD), data=data)

png("../output/int_esp_pub_lib_niñas.png",width=600,height=400)
plot_model(reg_esppub_libros2, type = "int", mdrt.values="meansd")
dev.off()
```

## Educacion padres sobre distribucion poder esp publico moderado por Proporción de niñas
```{r}
reg_esppub_educpad2 = lmer(esp_publico.est ~ 1 + Educ_padre + num_fem +
                   Educ_padre*num_fem +
                   (1 + Educ_padre | RBD), data=data)

png("../output/int_esp_pub_edu_niñas.png1",width=600,height=400)
plot_model(reg_esppub_educpad2, type = "int", mdrt.values="meansd")
dev.off()
```
