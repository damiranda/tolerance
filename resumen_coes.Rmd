---
title: Analizando la socialización política de las actitudes hacia la igualdad de género
author:
- Daniel Miranda^[Pontificia Universidad Católica de Chile, [damiran1@uc.cl](damiran1@uc.cl)]
- Julio Iturra^[Centro de Estudio de Conflicto y Cohesión Social, [julioiturrasanhueza@gmail.com](julioiturrasanhueza@gmail.com)]
- Anaís Herrera^[Instituto de Estudios Avanzados en Educación, [anais.herrera@ciae.uchile.com](anais.herrera@ciae.uchile.com)]
- Kevin Carrasco^[Universidad de Chile, [kevin.carrasco@ug.uchile.cl](kevin.carrasco@ug.uchile.cl)]
output:
  pdf_document:
    toc: no
  bookdown::pdf_document2:
    template: null
    keep_tex: no
    number_sections: no
    toc: no
  html_document:
    toc: yes
    code_folding: hide
    toc_float:
      collapsed: yes
      smooth_scroll: no
      number_sections: yes
editor_options:
  chunk_output_type: console
header-includes:
- \usepackage[spanish,es-tabla,es-nodecimaldot]{babel}
- \usepackage{times}
- \usepackage{caption}
- \captionsetup[figure, table]{labelfont={bf},labelformat={default},labelsep=period}
- \usepackage{graphicx}
- \usepackage{float}
- \usepackage{booktabs}
- \usepackage{longtable}
- \usepackage{array}
- \usepackage{multirow}
- \usepackage{wrapfig}
- \usepackage{colortbl}
- \usepackage{pdflscape}
- \usepackage{tabu}
- \usepackage{threeparttable}
geometry: margin=0.78in
bibliography: input/bib/Tolerancia.bib
csl: input/bib/apa6.csl
linkcolor: blue
---

```{r setup, echo=FALSE}
knitr::opts_chunk$set(
	error = TRUE,
	message = FALSE,
	warning = FALSE
)
```

# Actitudes hacia la igualdad de género: relevancia y antecedentes teórico-empíricos
En la actualidad existe un amplio esfuerzo por promover desde edades tempranas el reconocimiento activo de la igualdad de derechos entre hombres y mujeres [@unesco_Declaracion_1995] como un principio básico de la democracia. La importancia de la igualdad traspasa los ámbitos puramente éticos, encontrándose íntimamente relacionada con las posibilidades de desarrollo social y económico de los países [@onu_IGUALDAD_2016; @pnud_Desiguales_2017], con el sentimiento de plenitud y valía de las personas [@onu_IGUALDAD_2016] y con la vida democrática, la convivencia y la cohesión social en general [@pnud_Desiguales_2017]. A pesar de ello, persisten amplias desigualdades entre hombres y mujeres, siendo esto particularmente relevante en sociedades latinoamericanas y caribeñas que aún enfrentan grandes desafíos en términos de desigualdades sociales, políticas y económicas [@barcena_matriz_2016]. 

En este contexto, comprender la forma en que las creencias o actitudes hacia la igualdad de género son socializadas es un tópico que no ha recibido suficiente atención, particularmente en contextos como el chileno. La presente investigación busca aportar a la comprensión de los factores que influyen en el desarrollo de actitudes hacia la igualdad de género en jóvenes en edad escolar, indagando principalmente en el rol que cumplen dos agentes de socialización: la familia y la escuela.

Por un lado, el rol de la familia como un agente de socialización política ha sido analizado a partir de dos teorías. La primera se relaciona con la importancia de los recursos socioeconómicos, evidenciándose que estudiantes con más recursos tienen actitudes más positivas hacia la igualdad de género [@miranda_Political_2018; @dottisani_Best_2017]. La segunda tiene que ver con la transmisión intergeneracional de actitudes de apoderados a hijos, constatándose que las actitudes de apoderados hacia la igualdad de género en la esfera pública se relacionan a las de sus hijos [@spierings_Gender_2015].

Por otro lado, se ha destacado el rol de la educación en el fomento del reconocimiento activo de los derechos universales debido a que puede contribuir a formar actitudes vitalicias [@unesco_Declaracion_1995b]. Estudios previos han evidenciado que la apertura a la discusión en el aula se asocia con las actitudes hacia la igualdad de género [@schulz_Students_2018a]. Asimismo, se ha constatado que la proporción de inmigrantes en el aula aumenta el apoyo hacia la igualdad de derechos para inmigrantes [@isac_Native_2012a], en base a lo que suponemos que la proporción de niñas en el aula se relacionará con las actitudes hacia la igualdad de género.

En referencia a investigaciones anteriores, este estudio aportará nuevos antecedentes en dos direcciones. En primer lugar, se aúnan los distintos enfoques utilizados en estudios previos sobre las actitudes hacia la igualdad de género, incorporando en la medición de estas actitudes tanto elementos relativos a la igualdad de derechos y oportunidades entre hombres y mujeres, como indicadores orientados a la distribución de roles en las esferas pública y privada. En segundo lugar, se pretende aportar antecedentes sobre el posible rol mitigador de la escuela en la transmisión intergeneracional, cuestión que no ha sido abordada en los estudios revisados, evaluando si algunas características de la escuela permiten moderar la relación entre los recursos socioeconómicos y las actitudes del estudiante, y la relación entre las actitudes de los apoderados y las de sus hijos.

# Metodología
Se utilizaron los datos del estudio PACES 2019, producidos por el Fondecyt n°1181239, que cuenta con una muestra de estudiantes de segundo medio y sus apoderados de tres regiones chilenas: Antofagasta, Metropolitana y Maule. Los análisis se realizaron con 629 casos de 60 escuelas. Dada la estructura jerárquica de los datos se estimaron regresiones multinivel. Las hipótesis y el plan de análisis fueron pre-registrados en la plataforma OSF, puede acceder al documento en [este enlace](https://osf.io/jg6ub).

La operacionalización de las variables principales del estudio se muestra en la Tabla 1. Se estimaron puntuaciones factoriales para generar las variables con las que se trabajó. Las respuestas de los estudiantes a las tres dimensiones corresponden a las tres variables dependientes. 

```{r message=FALSE, warning=FALSE, include=FALSE, echo=FALSE}
pacman::p_load(knitr, kableExtra, dplyr)
```
```{r echo=FALSE}
table_format = if(is_html_output()) {
  "html"
} else if(is_latex_output()) {
  "latex"
}
```
```{r echo=FALSE}
tab <- read.csv(file = "input/tables/table.csv",
                header = 1,sep = ";",encoding = "UTF-8")

kable(tab,
      format = table_format,
      booktabs = T, 
      linesep = "",
      col.names =  c("Constructo","Dimensión","Indicador"),
      caption = "Actitudes hacia la igualdad de género.") %>%
  kable_styling(
    full_width = T,
    latex_options = c("hold_position"),
    position = "center",
    font_size = 8,
    bootstrap_options=c("striped", "bordered")) %>%
  column_spec(column = 1, width = "3 cm", ) %>%
  column_spec(column = 2,width = "4 cm") %>%
  column_spec(column = 3,width = "7 cm") %>%
  collapse_rows(columns = 1:2,valign = "middle")
```

# Análisis
En las tablas 2 y 3 se presenta un análisis descriptivo de las variables utilizadas en los análisis posteriores, con el objetivo de transparentar la distribución de los datos.

```{r include=FALSE, results='asis'}
pacman::p_load(summarytools,haven,sjPlot,dplyr,htmlwidgets, webshot, sjlabelled)
st_css()
st_options(lang = "es",
           footnote = NA,
           bootstrap.css = F,
           custom.css = "input/css/dfsummary.css")
load(file = "input/data-proc/data_proc.rda")

data_proc$igualdad.est <- set_label(x = data_proc$igualdad.est,label = "Actitudes del estudiante hacia la igualdad de género")
data_proc$esp_publico.est <- set_label(x = data_proc$esp_publico.est,label = "Actitudes del estudiante hacia la distribución igualitaria de roles en la esfera pública")
data_proc$esp_privado.est <- set_label(x = data_proc$esp_privado.est,label = "Actitudes del estudiante hacia la distribución igualitaria de roles en la esfera privada")
data_proc$igualdad.pad <- set_label(x = data_proc$igualdad.pad,label = "Actitudes del apoderado hacia la igualdad de género")
data_proc$esp_publico.pad <- set_label(x = data_proc$esp_publico.pad,label = "Actitudes del apoderado hacia la distribución igualitaria de roles en la esfera pública")
data_proc$esp_privado.pad <- set_label(x = data_proc$esp_privado.pad,label = "Actitudes del apoderado hacia la distribución igualitaria de roles en la esfera privada")
data_proc$Sexo <- set_label(x = data_proc$Sexo,label = "Sexo del estudiante")
data_proc$Educacion <- set_label(x = data_proc$Educacion,label = "Nivel educacional apoderado/a") # Etiquetar variable
data_proc$Libros_apod_rec <- set_label(x = data_proc$Libros_apod_rec,label = "Cantidad de libros en el hogar")
data_proc$quintiles_ingresos_pc_factor <- set_label(x = data_proc$quintiles_ingresos_pc_factor, label = "Ingresos per cápita del hogar en quintiles")
data_proc$ap_discusion <- set_label(x = data_proc$ap_discusion,label = "Percepción individual sobre la apertura a la discusión en el aula")
data_proc$mean_discusion <- set_label(x = data_proc$mean_discusion,label = "Percepción promedio del curso sobre la apertura a la discusión en el aula")
data_proc$num_fem <- set_label(x = data_proc$num_fem,label = "Proporción de niñas en el aula")
data_proc$dependencia <- set_label(x=data_proc$dependencia, label = "Dependencia administrativa de la escuela (control)")
data_proc$REGION <- set_label(x=data_proc$REGION, label = "Región (control)")
#data_proc$RBD <- set_label(x=data_proc$RBD, label = "RBD")
data_proc$c_civic <- set_label(x = data_proc$c_civic, label = "Conocimiento cívico conceptual (control)")

descr <-
  data_proc %>% 
  dplyr::select(
    igualdad.est,
    esp_publico.est,
    esp_privado.est,
    igualdad.pad,
    esp_publico.pad,
    esp_privado.pad,
    Sexo,
    Educacion,
    Libros_apod_rec,
    quintiles_ingresos_pc_factor,
    c_civic,
    ap_discusion,
    mean_discusion,
    num_fem,
    #RBD,
    dependencia,
    REGION) %>% ungroup()

df<- dfSummary(select(descr,igualdad.est:c_civic),
               plain.ascii = FALSE,
               style = "grid",
               tmp.img.dir = "/tmp",
               graph.magnif = 0.75,
               headings = F,  # encabezado
               varnumbers = F, # num variable
               labels.col = T, # etiquetas
               na.col = F,    # missing
               graph.col = T, # plot
               valid.col = T, # n valido
               col.widths = c(1000,10,10,10,10))
df$Variable <- NULL # delete variable column
view(df,file = "desc01.html")
webshot(url ="desc01.html" ,file ="output/desc01.png")
df02<- dfSummary(select(descr,ap_discusion:REGION),
               plain.ascii = FALSE,
               style = "grid",
               tmp.img.dir = "/tmp",
               graph.magnif = 0.75,
               headings = F,  # encabezado
               varnumbers = F, # num variable
               labels.col = T, # etiquetas
               na.col = F,    # missing
               graph.col = T, # plot
               valid.col = T, # n valido
               col.widths = c(1000,10,10,10,10))
df02$Variable <- NULL # delete variable column
view(df02,file = "desc02.html")
webshot(url ="desc02.html" ,file ="output/desc02.png",vheight = 10)
file.remove(c("desc01.html","desc02.html"))
```

```{r desc02, echo=FALSE, results='asis'}
kable(data.frame(image='![](output/desc02.png){width="500"}'),    # generar tabla
             caption="Descripción de las variables sobre la escuela",
             col.names = "",
             row.names = F,
             format = "pipe") %>%  kable_styling(latex_options = c("HOLD_position"),full_width = T)
```

```{r desc01, echo=FALSE, results='asis'}
kable(data.frame(image='![](output/desc01.png){width="500"}'),    # generar tabla
             caption="Descripción de las variables sobre el estudiante",
             col.names = "",
             row.names = F,
             format = "pipe") %>%  kable_styling(latex_options = c("HOLD_position"),full_width = T)
```

Los distintos análisis realizados se encuentran como anexos en el documento. 

Los principales resultados de esta investigación permiten avanzar en la comprensión del rol preponderante que posee la transmisión intergeneracional de las actitudes hacia la igualdad de género entre padres e hijos dentro del proceso de socialización familiar. Estos resultados demuestran que existe una consistencia actitudinal, que se transmite dentro de la familia, para las tres dimensiones de la igualdad de género analizadas.

A diferencia de investigaciones anteriores, el efecto de los recursos socioeconómicos de la familia sobre las actitudes de los jóvenes es principalmente indirecto, al estar mediado por las actitudes de los apoderados. Por lo tanto, sigue siendo la transmisión intergeneracional de actitudes la que influye de manera decisiva sobre las actitudes de los estudiantes. 

Adicionalmente, se destaca la relevancia del género, el nivel de conocimiento cívico y la apertura a la discusión en el aula de clases (tanto la percepción individual como grupal), demostrando la importancia de la escuela como un agente de socialización. Por último, se han testeado diversos efectos de interacción para evaluar si las características de la escuela mitigan (o aceleran) los procesos de socialización familiar y para evaluar si el género del estudiante interactúa con el resto de las variables analizadas en los modelos, pero ninguna de las interacciones analizadas fue significativa.

# Conclusión
De esta forma, se puede evidenciar que, aunque ambos agentes de socialización muestran un rol relevante en el desarrollo de las actitudes de los estudiantes, es el efecto de la familia el que predomina. Además, la escuela no interviene en lo que ocurre familiarmente. En ese sentido, la formación de actitudes igualitarias depende más de las condiciones de origen, que de lo que ocurre en un espacio más transversal como la escuela. Como tal, se hace necesario generar mecanismos dentro de la escuela que logren mitigar efectivamente la transmisión intergeneracional de actitudes, ya que de ello depende formar ciudadanos con una opinión favorable a la promoción y garantía de los derechos de todas las personas. Así, al formar ciudadanos con una opinión favorable hacia la igualdad de género se avanzará también en la construcción de sociedades más democráticas, tolerantes y cohesionadas.

\newpage

# Anexo 1: Actitudes del estudiante hacia la igualdad de derechos y oportunidades.
```{r, echo=FALSE}
pacman::p_load(summarytools,haven,sjPlot,dplyr,lme4,haven,texreg,knitr,kableExtra,bda,lmerTest)
load("input/data-proc/data.rda")
data_proc <- data %>% dplyr::select(
    igualdad.est,
    esp_publico.est,
    esp_privado.est,
    igualdad.pad,
    esp_publico.pad,
    esp_privado.pad,
    ap_discusion,
    mean_discusion,
    c_civic,
    Sexo,
    num_fem,
    Educacion,
    quintiles_ingresos_pc_factor,
    Libros_apod_rec,
    dependencia,
    RBD,
    REGION
) %>% as.data.frame() %>%  na.omit()

coef_names <- c(
          "Intercepto",
          "Niña (Ref. Niño)",
          "Educación Media (Ref. 8vo básico o menos)",
          "Educación Técnica Superior (IP o CFT)",
          "Educación universitaria o Posgrado",
          "Entre 11 y 25 libros (Ref. Entre 0 y 10 libros)",
          "Entre 26 y 100 libros",
          "Más de 100 libros",
          "Quintil 2 (Ref. Quintil 1)",
          "Quintil 3",
          "Quintil 4",
          "Quintil 5",
          "No sabe / No responde"
          )
omit_coef <- "(dependencia)|(REGION)|(c_civic)"
footnote<- "\\item %stars. \\item Todos los modelos son controlados por la región de residencia (p>0.05), la dependencia administrativa de la escuela (p>0.05) y el nivel de conocimiento cívico del estudiante ($p$<0.05)"
scale_box <- 0.825
```
```{r, echo=FALSE, results='asis'}
reg_igualdad1 <- lmer(igualdad.est ~ 1 + Sexo + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_igualdad2 <- lmer(igualdad.est ~ 1 + factor(Educacion) + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_igualdad3 <- lmer(igualdad.est ~ 1 + factor(Libros_apod_rec) + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_igualdad4 <- lmer(igualdad.est ~ 1 + factor(quintiles_ingresos_pc_factor) + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_igualdad5 <- lmer(igualdad.est ~ 1 + igualdad.pad + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_igualdad6 <- lmer(igualdad.est ~ 1 + ap_discusion + mean_discusion + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_igualdad7 <- lmer(igualdad.est ~ 1 + num_fem + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_igualdad8 <- lmer(igualdad.est ~ 1 + Sexo + factor(Educacion) + factor(Libros_apod_rec) + factor(quintiles_ingresos_pc_factor) + igualdad.pad + ap_discusion + mean_discusion + num_fem + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)

caption <- "Modelo de regresión multinivel para Igualdad de derechos y oportunidades"
knitreg(list(reg_igualdad1,reg_igualdad2,reg_igualdad3,reg_igualdad4,
             reg_igualdad5,reg_igualdad6,reg_igualdad7,reg_igualdad8),
        custom.model.names = c("Modelo 1",  "Modelo 2",  "Modelo 3",  "Modelo 4",  
                               "Modelo 5",  "Modelo 6",  "Modelo 7",  "Modelo 8"),
        custom.note = footnote,
        threeparttable = TRUE,
        omit.coef = omit_coef, 
        custom.coef.names = c(coef_names,
          "Actitudes igualdad de derechos (apod.)",
          "Apertura a la discusión (individual)",
          "Apertura a la discusión (promedio)",
          "Proporción de niñas en el aula"
        ),
       scalebox = scale_box,
       caption.above = T,
       caption=caption,
       float.pos="h!"
       )
```

\newpage

# Anexo 2: Actitudes del estudiante hacia la distribución igualitaria de roles en la esfera pública
```{r, echo=FALSE}
reg_esp.pub1 <- lmer(esp_publico.est ~ 1 + Sexo + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.pub2 <- lmer(esp_publico.est ~ 1 + factor(Educacion) + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.pub3 <- lmer(esp_publico.est ~ 1 + factor(Libros_apod_rec) + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.pub4 <- lmer(esp_publico.est ~ 1 + factor(quintiles_ingresos_pc_factor) + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.pub5 <- lmer(esp_publico.est ~ 1 + esp_publico.pad + factor(dependencia) + factor(REGION) + (1 | RBD), data=data_proc)
reg_esp.pub6 <- lmer(esp_publico.est ~ 1 + ap_discusion + mean_discusion + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.pub7 <- lmer(esp_publico.est ~ 1 + num_fem + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.pub8 <- lmer(esp_publico.est ~ 1 + Sexo + factor(Educacion) + factor(Libros_apod_rec) + factor(quintiles_ingresos_pc_factor) + esp_publico.pad + ap_discusion + mean_discusion + num_fem + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
```
```{r, echo=FALSE,results='asis'}
caption <- "Modelo de regresión multinivel para Distribución igualitaria de roles en la esfera pública"
knitreg(list(reg_esp.pub1,reg_esp.pub2,reg_esp.pub3,reg_esp.pub4,reg_esp.pub5,
             reg_esp.pub6,reg_esp.pub7,reg_esp.pub8), 
        custom.model.names = c("Modelo 1","Modelo 2","Modelo 3","Modelo 4",
                               "Modelo 5","Modelo 6","Modelo 7","Modelo 8"), 
        custom.note = footnote,
        threeparttable = TRUE,        
        omit.coef = omit_coef, 
        custom.coef.names = c(coef_names,
          "Actitudes distribución en esfera pública (apod.)",
          "Apertura a la discusión (individual)",
          "Apertura a la discusión (promedio)",
          "Proporción de niñas en el aula"
        ),
        scalebox = scale_box,
        caption.above = T,
        caption=caption,
        float.pos="h!"
        )
```

\newpage

# Anexo 3: Actitudes del estudiante hacia la distribución igualitaria de roles en la esfera privada
```{r echo=FALSE}
reg_esp.priv1 <- lmer(esp_privado.est ~ 1 + Sexo + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.priv2 <- lmer(esp_privado.est ~ 1 + factor(Educacion) + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.priv3 <- lmer(esp_privado.est ~ 1 + factor(Libros_apod_rec) + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.priv4 <- lmer(esp_privado.est ~ 1 + factor(quintiles_ingresos_pc_factor) + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.priv5 <- lmer(esp_privado.est ~ 1 + esp_privado.pad + factor(dependencia) + factor(REGION) + (1 | RBD), data=data_proc)
reg_esp.priv6 <- lmer(esp_privado.est ~ 1 + ap_discusion + mean_discusion + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.priv7 <- lmer(esp_privado.est ~ 1 + num_fem + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
reg_esp.priv8 <- lmer(esp_privado.est ~ 1 + Sexo + factor(Educacion) + factor(Libros_apod_rec) + factor(quintiles_ingresos_pc_factor) + esp_privado.pad + ap_discusion + mean_discusion + num_fem + factor(dependencia) + factor(REGION) + c_civic + (1 | RBD), data=data_proc)
```
```{r, echo=FALSE,results='asis'}
caption <- "Modelo de regresión multinivel Distribución igualitaria de roles en la esfera privada"
knitreg(list(reg_esp.priv1,reg_esp.priv2,reg_esp.priv3,reg_esp.priv4,reg_esp.priv5,
             reg_esp.priv6,reg_esp.priv7,reg_esp.priv8), 
        custom.model.names = c("Modelo 1","Modelo 2","Modelo 3","Modelo 4",
                               "Modelo 5","Modelo 6","Modelo 7","Modelo 8"),
        custom.note = footnote,
        omit.coef = omit_coef, 
        custom.coef.names = c(coef_names,
          "Actitudes distribución en esfera privada (apod.)",
          "Apertura a la discusión (individual)",
          "Apertura a la discusión (promedio)",
          "Proporción de niñas en el aula"
        ),
        scalebox = scale_box,
        threeparttable = TRUE,
        caption.above = T,
        caption=caption,
        float.pos="h!"
        )
```
\newpage

# Anexo 4: Actitudes del apoderado.

```{r, echo=FALSE}
pacman::p_load(summarytools,haven,sjPlot,dplyr,lme4,haven,texreg,knitr,kableExtra,bda,lmerTest)
load("input/data-proc/data.rda")
data_proc <- data %>% dplyr::select(
  RBD,
  igualdad.pad,
  esp_publico.pad,
  esp_privado.pad,
  Educacion,
  Libros_apod_rec,
  quintiles_ingresos_pc_factor,
  REGION,
) %>% as.data.frame() %>%  na.omit()
scale_box <- 0.65
```

```{r, echo=FALSE}
h4_igualdad.apod <- lmer(igualdad.pad ~ 1 + factor(Educacion) + factor(Libros_apod_rec) + factor(quintiles_ingresos_pc_factor) + factor(REGION) + (1 | RBD), data=data_proc)
h4_esp_pub.apod <- lmer(esp_publico.pad ~ 1 + factor(Educacion) + factor(Libros_apod_rec) + factor(quintiles_ingresos_pc_factor) + factor(REGION) + (1 | RBD), data=data_proc)
h4_esp_priv.apod <- lmer(esp_privado.pad ~ 1 + factor(Educacion) + factor(Libros_apod_rec) + factor(quintiles_ingresos_pc_factor) + factor(REGION) + (1 | RBD), data=data_proc)
```

```{r, echo=FALSE, results='asis'}
caption <- "Modelo de regresión multinivel para Actitudes de los apoderados"
knitreg(list(h4_igualdad.apod,h4_esp_pub.apod,h4_esp_priv.apod), 
        custom.model.names = c(
          "Igualdad de derechos y oportunidades",
          "Distribución igualitaria en la esfera pública",
          "Distribución igualitaria en la esfera privada"
        ), 
        custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05",  
        custom.coef.names = c(
          "Intercepto",
          "Educación Media (Ref. 8vo básico o menos)",
          "Educación Técnica Superior (IP o CFT)",
          "Educación universitaria o Posgrado",
          "Entre 11 y 25 libros (Ref. Entre 0 y 10 libros)",
          "Entre 26 y 100 libros",
          "Más de 100 libros",
          "Quintil 2 (Ref. Quintil 1)",
          "Quintil 3",
          "Quintil 4",
          "Quintil 5",
          "No sabe / No responde",
          "Reg. del Maule (Ref. Reg. de Antofagasta)",
          "Reg. Metropolitana"
        ),
       scalebox = scale_box,
       caption.above = T,
       caption=caption,
       float.pos="h!"
       )
```

\newpage

# Anexo 5: Análisis de los efectos de mediación
```{r models-mediation, include=FALSE,cache=TRUE}
pacman::p_load(stargazer, ggplot2, sjmisc, car, sjlabelled, haven, cowplot,
               sjPlot, summarytools, kableExtra, corrplot, coefplot, ltm,
               polycor,psych, lme4, ppcor, texreg, skimr, gtools, bda, 
               lmerTest, Matrix, extrafont, sessioninfo, dplyr,mediation,
               fastDummies,gtools)
load("input/data-proc/data.rda")
data_proc=data %>% 
  dplyr::select(
    igualdad.est,
    esp_publico.est,
    esp_privado.est,
    Sexo,
    ap_discusion,
    mean_discusion,
    num_fem,
    RBD,
    igualdad.pad,
    esp_publico.pad,
    esp_privado.pad,
    Educacion,
    Libros_apod,
    Libros_apod_rec,
    quintiles_ingresos_pc_factor,
    dependencia,
    REGION,
    c_civic
  ) %>% as.data.frame() 
data_proc <- na.omit(data_proc)

data_proc$Educacion <- factor(data_proc$Educacion, 
                              levels = c("8vo básico o menos", 
                                         "Educación Media", 
                                         "Educación Téc.Superior", 
                                         "Universidad o Posgrado"),
                              labels = c("ed_basica", "ed_media", 
                                         "ed_tecni", "ed_supe"))

data_proc$Libros_apod_rec <- factor(data_proc$Libros_apod_rec, 
                                    levels = c("Entre 0 y 10 libros",
                                               "Entre 11 y 25 libros",
                                               "Entre 26 y 100 libros",
                                               "Más de 100 libros"), 
                                    labels = c("libros1", "libros2", 
                                               "libros3", "libros4"))

data_proc$quintiles_ingresos_pc_factor <- factor(data_proc$quintiles_ingresos_pc_factor, 
                                                 levels = c("Quintil 1",
                                                            "Quintil 2",
                                                            "Quintil 3",
                                                            "Quintil 4",
                                                            "Quintil 5",
                                                            "Ns/Nr"),
                                                 labels = c("quintil1",
                                                            "quintil2",
                                                            "quintil3",
                                                            "quintil4",
                                                            "quintil5",
                                                            "quintilna"))

data_proc <- fastDummies::dummy_cols(data_proc, 
                                     select_columns = "Educacion")
data_proc <- fastDummies::dummy_cols(data_proc, 
                                     select_columns = "Libros_apod_rec")
data_proc <- fastDummies::dummy_cols(data_proc, 
                                     select_columns = "quintiles_ingresos_pc_factor")

reg_med_ig1 <- lme4::lmer(igualdad.pad ~ Educacion_ed_media + Educacion_ed_tecni + Educacion_ed_supe + Libros_apod_rec_libros2 + Libros_apod_rec_libros3 + Libros_apod_rec_libros4 + quintiles_ingresos_pc_factor_quintil2 + quintiles_ingresos_pc_factor_quintil3 + quintiles_ingresos_pc_factor_quintil4 + quintiles_ingresos_pc_factor_quintil5 + quintiles_ingresos_pc_factor_quintilna + REGION + dependencia + (1 | RBD), data = data_proc)

reg_out_ig1 <- lme4::lmer(igualdad.est ~ igualdad.pad + Educacion_ed_media + Educacion_ed_tecni + Educacion_ed_supe + Libros_apod_rec_libros2 + Libros_apod_rec_libros3 + Libros_apod_rec_libros4 + quintiles_ingresos_pc_factor_quintil2 + quintiles_ingresos_pc_factor_quintil3 + quintiles_ingresos_pc_factor_quintil4 + quintiles_ingresos_pc_factor_quintil5 + quintiles_ingresos_pc_factor_quintilna + Sexo + ap_discusion + mean_discusion + num_fem + c_civic + REGION + dependencia + (1 | RBD), data=data_proc)
# Educacion
set.seed(123)
med_out_iged1 <- mediate(reg_med_ig1, reg_out_ig1,
                         treat = "Educacion_ed_media", 
                         mediator = "igualdad.pad", sims = 100)
med_out_iged2 <- mediate(reg_med_ig1, reg_out_ig1,
                         treat = "Educacion_ed_tecni", 
                         mediator = "igualdad.pad", sims = 100)
med_out_iged3 <- mediate(reg_med_ig1, reg_out_ig1, 
                         treat = "Educacion_ed_supe", 
                         mediator = "igualdad.pad", sims = 100)
# Libros
med_out_iglib1 <- mediate(reg_med_ig1, reg_out_ig1, 
                          treat = "Libros_apod_rec_libros2", 
                          mediator = "igualdad.pad", sims = 100)
med_out_iglib2 <- mediate(reg_med_ig1, reg_out_ig1, 
                          treat = "Libros_apod_rec_libros3", 
                          mediator = "igualdad.pad", sims = 100)
med_out_iglib3 <- mediate(reg_med_ig1, reg_out_ig1, 
                          treat = "Libros_apod_rec_libros4",
                          mediator = "igualdad.pad", sims = 100)
summary(med_out_iglib1)
summary(med_out_iglib2)
summary(med_out_iglib3)
# Ingresos
med_out_iging1 <- mediate(reg_med_ig1, reg_out_ig1, 
                          treat = "quintiles_ingresos_pc_factor_quintil2", 
                          mediator = "igualdad.pad", sims = 100)
med_out_iging2 <- mediate(reg_med_ig1, reg_out_ig1, 
                          treat = "quintiles_ingresos_pc_factor_quintil3", 
                          mediator = "igualdad.pad", sims = 100)
med_out_iging3 <- mediate(reg_med_ig1, reg_out_ig1, 
                          treat = "quintiles_ingresos_pc_factor_quintil4", 
                          mediator = "igualdad.pad", sims = 100)
med_out_iging4 <- mediate(reg_med_ig1, reg_out_ig1, 
                          treat = "quintiles_ingresos_pc_factor_quintil5", 
                          mediator = "igualdad.pad", sims = 100)
med_out_iging5 <- mediate(reg_med_ig1, reg_out_ig1, 
                          treat = "quintiles_ingresos_pc_factor_quintilna", 
                          mediator = "igualdad.pad", sims = 100)

#### Espacio público
reg_med_pub1 <- lme4::lmer(esp_publico.pad ~ Educacion_ed_media + Educacion_ed_tecni + Educacion_ed_supe + Libros_apod_rec_libros2 + Libros_apod_rec_libros3 + Libros_apod_rec_libros4 + quintiles_ingresos_pc_factor_quintil2 + quintiles_ingresos_pc_factor_quintil3 + quintiles_ingresos_pc_factor_quintil4 + quintiles_ingresos_pc_factor_quintil5 + quintiles_ingresos_pc_factor_quintilna + REGION + dependencia + (1 | RBD), data = data_proc)

reg_out_pub1 <- lme4::lmer(esp_publico.est ~ esp_publico.pad + Educacion_ed_media + Educacion_ed_tecni + Educacion_ed_supe + Libros_apod_rec_libros2 + Libros_apod_rec_libros3 + Libros_apod_rec_libros4 + quintiles_ingresos_pc_factor_quintil2 + quintiles_ingresos_pc_factor_quintil3 + quintiles_ingresos_pc_factor_quintil4 + quintiles_ingresos_pc_factor_quintil5 + quintiles_ingresos_pc_factor_quintilna + Sexo + ap_discusion + mean_discusion + num_fem + c_civic + REGION + dependencia + (1 | RBD), data=data_proc)

# Educacion
med_out_pubed1 <- mediate(reg_med_pub1, reg_out_pub1, 
                          treat = "Educacion_ed_media", 
                          mediator = "esp_publico.pad", sims = 100)
med_out_pubed2 <- mediate(reg_med_pub1, reg_out_pub1, 
                          treat = "Educacion_ed_tecni", 
                          mediator = "esp_publico.pad", sims = 100)
med_out_pubed3 <- mediate(reg_med_pub1, reg_out_pub1, 
                          treat = "Educacion_ed_supe", 
                          mediator = "esp_publico.pad", sims = 100)

# Libros
med_out_publib1 <- mediate(reg_med_pub1, reg_out_pub1, 
                           treat = "Libros_apod_rec_libros2", 
                           mediator = "esp_publico.pad", sims = 100)
med_out_publib2 <- mediate(reg_med_pub1, reg_out_pub1, 
                           treat = "Libros_apod_rec_libros3",
                           mediator = "esp_publico.pad", sims = 100)
med_out_publib3 <- mediate(reg_med_pub1, reg_out_pub1, 
                           treat = "Libros_apod_rec_libros4",
                           mediator = "esp_publico.pad", sims = 100)

# Ingresos
med_out_pubing1 <- mediate(reg_med_pub1, reg_out_pub1, 
                           treat = "quintiles_ingresos_pc_factor_quintil2", 
                           mediator = "esp_publico.pad", sims = 100)
med_out_pubing2 <- mediate(reg_med_pub1, reg_out_pub1, 
                           treat = "quintiles_ingresos_pc_factor_quintil3", 
                           mediator = "esp_publico.pad", sims = 100)
med_out_pubing3 <- mediate(reg_med_pub1, reg_out_pub1, 
                           treat = "quintiles_ingresos_pc_factor_quintil4", 
                           mediator = "esp_publico.pad", sims = 100)
med_out_pubing4 <- mediate(reg_med_pub1, reg_out_pub1, 
                           treat = "quintiles_ingresos_pc_factor_quintil5", 
                           mediator = "esp_publico.pad", sims = 100)
med_out_pubing5 <- mediate(reg_med_pub1, reg_out_pub1, 
                           treat = "quintiles_ingresos_pc_factor_quintilna", 
                           mediator = "esp_publico.pad", sims = 100)

#### Espacio privado
reg_med_priv1 <- lme4::lmer(esp_privado.pad ~ Educacion_ed_media + Educacion_ed_tecni + Educacion_ed_supe + Libros_apod_rec_libros2 + Libros_apod_rec_libros3 + Libros_apod_rec_libros4 + quintiles_ingresos_pc_factor_quintil2 + quintiles_ingresos_pc_factor_quintil3 + quintiles_ingresos_pc_factor_quintil4 + quintiles_ingresos_pc_factor_quintil5 + quintiles_ingresos_pc_factor_quintilna + REGION + dependencia + (1 | RBD), data = data_proc)

reg_out_priv1 <- lme4::lmer(esp_privado.est ~ esp_privado.pad + Educacion_ed_media + Educacion_ed_tecni + Educacion_ed_supe + Libros_apod_rec_libros2 + Libros_apod_rec_libros3 + Libros_apod_rec_libros4 + quintiles_ingresos_pc_factor_quintil2 + quintiles_ingresos_pc_factor_quintil3 + quintiles_ingresos_pc_factor_quintil4 + quintiles_ingresos_pc_factor_quintil5 + quintiles_ingresos_pc_factor_quintilna + Sexo + ap_discusion + mean_discusion + num_fem + c_civic + REGION + dependencia + (1 | RBD), data=data_proc)

# Educacion
med_out_prived1 <- mediate(reg_med_priv1, reg_out_priv1, 
                           treat = "Educacion_ed_media", 
                           mediator = "esp_privado.pad", sims = 100)
med_out_prived2 <- mediate(reg_med_priv1, reg_out_priv1, 
                           treat = "Educacion_ed_tecni", 
                           mediator = "esp_privado.pad", sims = 100)
med_out_prived3 <- mediate(reg_med_priv1, reg_out_priv1, 
                           treat = "Educacion_ed_supe", 
                           mediator = "esp_privado.pad", sims = 100)

# Libros
med_out_privlib1 <- mediate(reg_med_priv1, reg_out_priv1, 
                            treat = "Libros_apod_rec_libros2", 
                            mediator = "esp_privado.pad", sims = 100)
med_out_privlib2 <- mediate(reg_med_priv1, reg_out_priv1, 
                            treat = "Libros_apod_rec_libros3",
                            mediator = "esp_privado.pad", sims = 100)
med_out_privlib3 <- mediate(reg_med_priv1, reg_out_priv1, 
                            treat = "Libros_apod_rec_libros4", 
                            mediator = "esp_privado.pad", sims = 100)
# Ingresos
med_out_priving1 <- mediate(reg_med_priv1, reg_out_priv1,
                            treat = "quintiles_ingresos_pc_factor_quintil2", 
                            mediator = "esp_privado.pad", sims = 100)
med_out_priving2 <- mediate(reg_med_priv1, reg_out_priv1, 
                            treat = "quintiles_ingresos_pc_factor_quintil3", 
                            mediator = "esp_privado.pad", sims = 100)
med_out_priving3 <- mediate(reg_med_priv1, reg_out_priv1, 
                            treat = "quintiles_ingresos_pc_factor_quintil4", 
                            mediator = "esp_privado.pad", sims = 100)
med_out_priving4 <- mediate(reg_med_priv1, reg_out_priv1, 
                            treat = "quintiles_ingresos_pc_factor_quintil5", 
                            mediator = "esp_privado.pad", sims = 100)
med_out_priving5 <- mediate(reg_med_priv1, reg_out_priv1, 
                            treat = "quintiles_ingresos_pc_factor_quintilna", 
                            mediator = "esp_privado.pad", sims = 100)

directos.DV1 = 
  c(paste0(round(med_out_iged1[["z0"]],3), stars.pval(med_out_iged1[["z0.p"]])),
    paste0(round(med_out_iged2[["z0"]],3), stars.pval(med_out_iged2[["z0.p"]])),
    paste0(round(med_out_iged3[["z0"]],3), stars.pval(med_out_iged3[["z0.p"]])),
    paste0(round(med_out_iglib1[["z0"]],3),stars.pval(med_out_iglib1[["z0.p"]])),
    paste0(round(med_out_iglib2[["z0"]],3),stars.pval(med_out_iglib2[["z0.p"]])),
    paste0(round(med_out_iglib3[["z0"]],3),stars.pval(med_out_iglib3[["z0.p"]])),
    paste0(round(med_out_iging1[["z0"]],3),stars.pval(med_out_iging1[["z0.p"]])),
    paste0(round(med_out_iging2[["z0"]],3),stars.pval(med_out_iging2[["z0.p"]])),
    paste0(round(med_out_iging3[["z0"]],3),stars.pval(med_out_iging3[["z0.p"]])),
    paste0(round(med_out_iging4[["z0"]],3),stars.pval(med_out_iging4[["z0.p"]])),
    paste0(round(med_out_iging5[["z0"]],3),stars.pval(med_out_iging5[["z0.p"]])))
indirecto.DV1 = 
  c(paste0(round(med_out_iged1[["d0"]],3), stars.pval(med_out_iged1[["d0.p"]])),
    paste0(round(med_out_iged2[["d0"]],3), stars.pval(med_out_iged2[["d0.p"]])),
    paste0(round(med_out_iged3[["d0"]],3), stars.pval(med_out_iged3[["d0.p"]])),
    paste0(round(med_out_iglib1[["d0"]],3),stars.pval(med_out_iglib1[["d0.p"]])),
    paste0(round(med_out_iglib2[["d0"]],3),stars.pval(med_out_iglib2[["d0.p"]])),
    paste0(round(med_out_iglib3[["d0"]],3),stars.pval(med_out_iglib3[["d0.p"]])),
    paste0(round(med_out_iging1[["d0"]],3),stars.pval(med_out_iging1[["d0.p"]])),
    paste0(round(med_out_iging2[["d0"]],3),stars.pval(med_out_iging2[["d0.p"]])),
    paste0(round(med_out_iging3[["d0"]],3),stars.pval(med_out_iging3[["d0.p"]])),
    paste0(round(med_out_iging4[["d0"]],3),stars.pval(med_out_iging4[["d0.p"]])),
    paste0(round(med_out_iging5[["d0"]],3),stars.pval(med_out_iging5[["d0.p"]])))
totales.DV1 =
  c(paste0(round(med_out_iged1[["tau.coef"]],3), stars.pval(med_out_iged1[["tau.p"]])),
    paste0(round(med_out_iged2[["tau.coef"]],3), stars.pval(med_out_iged2[["tau.p"]])),
    paste0(round(med_out_iged3[["tau.coef"]],3), stars.pval(med_out_iged3[["tau.p"]])),
    paste0(round(med_out_iglib1[["tau.coef"]],3),stars.pval(med_out_iglib1[["tau.p"]])),
    paste0(round(med_out_iglib2[["tau.coef"]],3),stars.pval(med_out_iglib2[["tau.p"]])),
    paste0(round(med_out_iglib3[["tau.coef"]],3),stars.pval(med_out_iglib3[["tau.p"]])),
    paste0(round(med_out_iging1[["tau.coef"]],3),stars.pval(med_out_iging1[["tau.p"]])),
    paste0(round(med_out_iging2[["tau.coef"]],3),stars.pval(med_out_iging2[["tau.p"]])),
    paste0(round(med_out_iging3[["tau.coef"]],3),stars.pval(med_out_iging3[["tau.p"]])),
    paste0(round(med_out_iging4[["tau.coef"]],3),stars.pval(med_out_iging4[["tau.p"]])),
    paste0(round(med_out_iging5[["tau.coef"]],3),stars.pval(med_out_iging5[["tau.p"]])))
pct_ind.DV1 =
  c(paste0(round(med_out_iged1[["n.avg"]]*100,2),"%"), 
    paste0(round(med_out_iged2[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_iged3[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_iglib1[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_iglib2[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_iglib3[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_iging1[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_iging2[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_iging3[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_iging4[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_iging5[["n.avg"]]*100,2),"%"))
directos.DV2 = 
  c(paste0(round(med_out_pubed1[["z0"]],3),stars.pval(med_out_pubed1[["z0.p"]])),
    paste0(round(med_out_pubed2[["z0"]],3),stars.pval(med_out_pubed2[["z0.p"]])),
    paste0(round(med_out_pubed3[["z0"]],3),stars.pval(med_out_pubed3[["z0.p"]])),
    paste0(round(med_out_publib1[["z0"]],3),stars.pval(med_out_publib1[["z0.p"]])),
    paste0(round(med_out_publib2[["z0"]],3),stars.pval(med_out_publib2[["z0.p"]])),
    paste0(round(med_out_publib3[["z0"]],3),stars.pval(med_out_publib3[["z0.p"]])),
    paste0(round(med_out_pubing1[["z0"]],3),stars.pval(med_out_pubing1[["z0.p"]])),
    paste0(round(med_out_pubing2[["z0"]],3),stars.pval(med_out_pubing2[["z0.p"]])),
    paste0(round(med_out_pubing3[["z0"]],3),stars.pval(med_out_pubing3[["z0.p"]])),
    paste0(round(med_out_pubing4[["z0"]],3),stars.pval(med_out_pubing4[["z0.p"]])),
    paste0(round(med_out_pubing5[["z0"]],3),stars.pval(med_out_pubing5[["z0.p"]])))
indirecto.DV2 = 
  c(paste0(round(med_out_pubed1[["d0"]],3),stars.pval(med_out_pubed1[["d0.p"]])),
    paste0(round(med_out_pubed2[["d0"]],3),stars.pval(med_out_pubed2[["d0.p"]])),
    paste0(round(med_out_pubed3[["d0"]],3),stars.pval(med_out_pubed3[["d0.p"]])),
    paste0(round(med_out_publib1[["d0"]],3),stars.pval(med_out_publib1[["d0.p"]])),
    paste0(round(med_out_publib2[["d0"]],3),stars.pval(med_out_publib2[["d0.p"]])),
    paste0(round(med_out_publib3[["d0"]],3),stars.pval(med_out_publib3[["d0.p"]])),
    paste0(round(med_out_pubing1[["d0"]],3),stars.pval(med_out_pubing1[["d0.p"]])),
    paste0(round(med_out_pubing2[["d0"]],3),stars.pval(med_out_pubing2[["d0.p"]])),
    paste0(round(med_out_pubing3[["d0"]],3),stars.pval(med_out_pubing3[["d0.p"]])),
    paste0(round(med_out_pubing4[["d0"]],3),stars.pval(med_out_pubing4[["d0.p"]])),
    paste0(round(med_out_pubing5[["d0"]],3),stars.pval(med_out_pubing5[["d0.p"]])))
totales.DV2 = 
  c(paste0(round(med_out_pubed1[["tau.coef"]],3),stars.pval(med_out_pubed1[["tau.p"]])),
    paste0(round(med_out_pubed2[["tau.coef"]],3),stars.pval(med_out_pubed2[["tau.p"]])),
    paste0(round(med_out_pubed3[["tau.coef"]],3),stars.pval(med_out_pubed3[["tau.p"]])),
    paste0(round(med_out_publib1[["tau.coef"]],3),stars.pval(med_out_publib1[["tau.p"]])),
    paste0(round(med_out_publib2[["tau.coef"]],3),stars.pval(med_out_publib2[["tau.p"]])),
    paste0(round(med_out_publib3[["tau.coef"]],3),stars.pval(med_out_publib3[["tau.p"]])),
    paste0(round(med_out_pubing1[["tau.coef"]],3),stars.pval(med_out_pubing1[["tau.p"]])),
    paste0(round(med_out_pubing2[["tau.coef"]],3),stars.pval(med_out_pubing2[["tau.p"]])),
    paste0(round(med_out_pubing3[["tau.coef"]],3),stars.pval(med_out_pubing3[["tau.p"]])),
    paste0(round(med_out_pubing4[["tau.coef"]],3),stars.pval(med_out_pubing4[["tau.p"]])),
    paste0(round(med_out_pubing5[["tau.coef"]],3),stars.pval(med_out_pubing5[["tau.p"]])))
pct_ind.DV2 = 
  c(paste0(round(med_out_pubed1[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_pubed2[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_pubed3[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_publib1[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_publib2[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_publib3[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_pubing1[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_pubing2[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_pubing3[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_pubing4[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_pubing5[["n.avg"]]*100,2),"%"))

directos.DV3 = 
  c(paste0(round(med_out_prived1[["z0"]],3),stars.pval(med_out_prived1[["z0.p"]])),
    paste0(round(med_out_prived2[["z0"]],3),stars.pval(med_out_prived2[["z0.p"]])),
    paste0(round(med_out_prived3[["z0"]],3),stars.pval(med_out_prived3[["z0.p"]])),
    paste0(round(med_out_privlib1[["z0"]],3),stars.pval(med_out_privlib1[["z0.p"]])),
    paste0(round(med_out_privlib2[["z0"]],3),stars.pval(med_out_privlib2[["z0.p"]])),
    paste0(round(med_out_privlib3[["z0"]],3),stars.pval(med_out_privlib3[["z0.p"]])),
    paste0(round(med_out_priving1[["z0"]],3),stars.pval(med_out_priving1[["z0.p"]])),
    paste0(round(med_out_priving2[["z0"]],3),stars.pval(med_out_priving2[["z0.p"]])),
    paste0(round(med_out_priving3[["z0"]],3),stars.pval(med_out_priving3[["z0.p"]])),
    paste0(round(med_out_priving4[["z0"]],3),stars.pval(med_out_priving4[["z0.p"]])),
    paste0(round(med_out_priving5[["z0"]],3),stars.pval(med_out_priving5[["z0.p"]])))
indirecto.DV3 = 
  c(paste0(round(med_out_prived1[["d0"]],3),stars.pval(med_out_prived1[["d0.p"]])),
    paste0(round(med_out_prived2[["d0"]],3),stars.pval(med_out_prived2[["d0.p"]])),
    paste0(round(med_out_prived3[["d0"]],3),stars.pval(med_out_prived3[["d0.p"]])),
    paste0(round(med_out_privlib1[["d0"]],3),stars.pval(med_out_privlib1[["d0.p"]])),
    paste0(round(med_out_privlib2[["d0"]],3),stars.pval(med_out_privlib2[["d0.p"]])),
    paste0(round(med_out_privlib3[["d0"]],3),stars.pval(med_out_privlib3[["d0.p"]])),
    paste0(round(med_out_priving1[["d0"]],3),stars.pval(med_out_priving1[["d0.p"]])),
    paste0(round(med_out_priving2[["d0"]],3),stars.pval(med_out_priving2[["d0.p"]])),
    paste0(round(med_out_priving3[["d0"]],3),stars.pval(med_out_priving3[["d0.p"]])),
    paste0(round(med_out_priving4[["d0"]],3),stars.pval(med_out_priving4[["d0.p"]])),
    paste0(round(med_out_priving5[["d0"]],3),stars.pval(med_out_priving5[["d0.p"]])))
totales.DV3 = 
  c(paste0(round(med_out_prived1[["tau.coef"]],3),stars.pval(med_out_prived1[["tau.p"]])),
    paste0(round(med_out_prived2[["tau.coef"]],3),stars.pval(med_out_prived2[["tau.p"]])),
    paste0(round(med_out_prived3[["tau.coef"]],3),stars.pval(med_out_prived3[["tau.p"]])),
    paste0(round(med_out_privlib1[["tau.coef"]],3),stars.pval(med_out_privlib1[["tau.p"]])),
    paste0(round(med_out_privlib2[["tau.coef"]],3),stars.pval(med_out_privlib2[["tau.p"]])),
    paste0(round(med_out_privlib3[["tau.coef"]],3),stars.pval(med_out_privlib3[["tau.p"]])),
    paste0(round(med_out_priving1[["tau.coef"]],3),stars.pval(med_out_priving1[["tau.p"]])),
    paste0(round(med_out_priving2[["tau.coef"]],3),stars.pval(med_out_priving2[["tau.p"]])),
    paste0(round(med_out_priving3[["tau.coef"]],3),stars.pval(med_out_priving3[["tau.p"]])),
    paste0(round(med_out_priving4[["tau.coef"]],3),stars.pval(med_out_priving4[["tau.p"]])),
    paste0(round(med_out_priving5[["tau.coef"]],3),stars.pval(med_out_priving5[["tau.p"]])))
pct_ind.DV3 = 
  c(paste0(round(med_out_prived1[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_prived2[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_prived3[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_privlib1[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_privlib2[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_privlib3[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_priving1[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_priving2[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_priving3[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_priving4[["n.avg"]]*100,2),"%"),
    paste0(round(med_out_priving5[["n.avg"]]*100,2),"%"))

collapse_rows_dt2 <-
  data.frame(vars = c(rep("Educación de los padres", 3),
                    rep("Cantidad de libros", 3),
                    rep("Quintiles de ingreso", 5)),
           catego = c(sjlabelled::get_labels(data$Educacion)[-1],
                      sjlabelled::get_labels(data$Libros_apod_rec)[-1],
                      sjlabelled::get_labels(data$quintiles_ingresos_pc_factor)[-1]),
           directos.DV1,indirecto.DV1,totales.DV1,pct_ind.DV1, #derechos y oport
           directos.DV2,indirecto.DV2,totales.DV2,pct_ind.DV2, #espacio publico
           directos.DV3,indirecto.DV3,totales.DV3,pct_ind.DV3) #espacio privado
```

```{r table-mediation, echo=FALSE}
kbl(collapse_rows_dt2, 
    caption = "Análisis de mediación de nivel socioeconómico para las actitudes igualitarias",
    align = "llcccccccccccccccc", booktabs = T,
    col.names =  c("Variable",
                   "Categorías", 
                   "Efectos Directos", "Efectos Indirectos", "Efectos Totales",
                   "% de Efectos Indirectos", 
                   "Efectos Directos", "Efectos Indirectos", "Efectos Totales", 
                   "% de Efectos Indirectos", 
                   "Efectos Directos", "Efectos Indirectos", "Efectos Totales",
                   "% de Efectos Indirectos")) %>%
  add_header_above(c(" " = 2,
                     "Igualdad de derechos y oportunidades"=4, 
                     "Distribución igualitaria de roles en la esfera pública"=4, 
                     "Distribución igualitaria de roles en la esfera privada"=4), 
                   bold = T)%>%  
  kable_styling(latex_options = c("scale_down","HOLD_position"),
                full_width = F) %>%
  column_spec(1, bold = T) %>%
  column_spec(column = 3:14,width = "1.5cm") %>%
  collapse_rows(columns = 1:2, valign = "middle") %>% 
  footnote(general = "***p <$ 0.001, **p < 0.01, *p < 0.05",
           footnote_as_chunk = T,general_title = "Nota: ")
```

\newpage

# Referencias bibliográficas

